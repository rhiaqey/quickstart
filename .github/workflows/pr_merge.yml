name: PR Merge

on:
  push:
    branches:
      - master

env:
  CI: true

permissions:
  contents: write

jobs:
  Publish:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: 'Get latest tag'
        id: prev
        uses: "WyriHaximus/github-action-get-previous-tag@v1"
        with:
          fallback: 1.0.0 # Optional fallback tag to use when no tag can be found

      - name: 'Get next patch version'
        id: next
        uses: "WyriHaximus/github-action-next-semvers@v1"
        with:
          version: ${{ steps.prev.outputs.tag }}

      - name: Create a GitHub release
        uses: ncipollo/release-action@v1
        with:
          tag: v${{ steps.next.outputs.patch }}
          # name: Release ${{ steps.next.outputs.patch }}
          commit: Release ${{ steps.next.outputs.patch }}
